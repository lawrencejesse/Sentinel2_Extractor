Running SIMPLIFIED lease vs field analysis...

This compares the lease area directly to the surrounding healthy field.

Processing 2017 - Spring Wheat...
  - Extracting lease embeddings...
  - Extracting field embeddings (healthy reference)...
  ✗ Error: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''

Processing 2018 - Canola and Rapeseed...
  - Extracting lease embeddings...
  - Extracting field embeddings (healthy reference)...
  ✗ Error: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''

Processing 2019 - Spring Wheat...
  - Extracting lease embeddings...
  - Extracting field embeddings (healthy reference)...
  ✗ Error: Image.reduceRegion: Too many pixels in the region. Found 637348081, but maxPixels allows only 100000000.
Ensure that you are not aggregating at a higher resolution than you intended; that is a frequent cause of this error. If not, then you may set the 'maxPixels' argument to a limit suitable for your computation; set 'bestEffort' to true to aggregate at whatever scale results in 'maxPixels' total pixels; or both.

Processing 2020 - Canola and Rapeseed...
  - Extracting lease embeddings...
  - Extracting field embeddings (healthy reference)...
  ✗ Error: Image.reduceRegion: Too many pixels in the region. Found 124274786, but maxPixels allows only 100000000.
Ensure that you are not aggregating at a higher resolution than you intended; that is a frequent cause of this error. If not, then you may set the 'maxPixels' argument to a limit suitable for your computation; set 'bestEffort' to true to aggregate at whatever scale results in 'maxPixels' total pixels; or both.

Processing 2021 - Spring Wheat...
  - Extracting lease embeddings...
  - Extracting field embeddings (healthy reference)...
  ✗ Error: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''

Processing 2022 - Canola and Rapeseed...
  - Extracting lease embeddings...
  - Extracting field embeddings (healthy reference)...
  ✗ Error: ufunc 'isnan' not supported for the input types, and the inputs could not be safely coerced to any supported types according to the casting rule ''safe''

Processing 2023 - Spring Wheat...
  - Extracting lease embeddings...
  - Extracting field embeddings (healthy reference)...
  ✗ Error: Image.reduceRegion: Too many pixels in the region. Found 1078072490, but maxPixels allows only 100000000.
Ensure that you are not aggregating at a higher resolution than you intended; that is a frequent cause of this error. If not, then you may set the 'maxPixels' argument to a limit suitable for your computation; set 'bestEffort' to true to aggregate at whatever scale results in 'maxPixels' total pixels; or both.

================================================================================
SIMPLIFIED ANALYSIS COMPLETE
================================================================================

Recovery scores show how similar the lease is to the healthy field:
• 90-100%: Excellent recovery - lease performing like healthy field
• 80-90%: Good recovery - minor differences from field
• 70-80%: Moderate recovery - noticeable differences
• <70%: Poor recovery - significant differences from field

---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
/tmp/ipython-input-4140843472.py in <cell line: 0>()
     62     print("• <70%: Poor recovery - significant differences from field\n")
     63 
---> 64     display(simple_results_df[['year', 'crop', 'cosine_similarity', 'recovery_percent']])
     65 else:
     66     print("Please complete all previous steps first.")

2 frames
/usr/local/lib/python3.12/dist-packages/pandas/core/indexes/base.py in _raise_if_missing(self, key, indexer, axis_name)
   6247         if nmissing:
   6248             if nmissing == len(indexer):
-> 6249                 raise KeyError(f"None of [{key}] are in the [{axis_name}]")
   6250 
   6251             not_found = list(ensure_index(key)[missing_mask.nonzero()[0]].unique())

KeyError: "None of [Index(['year', 'crop', 'cosine_similarity', 'recovery_percent'], dtype='object')] are in the [columns]"
